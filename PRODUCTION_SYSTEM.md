# üè≠ –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–∫—É–ø–æ–∫

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–∫—É–ø–æ–∫ –¥–ª—è **–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏–Ω–∑ –∏ —Ä–∞—Å—Ç–≤–æ—Ä–æ–≤** —Å ML-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ 4 –≥–æ–¥–∞ –ø–æ 86 SKU.

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **ML-–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å–ø—Ä–æ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞** –∑–∞–∫—É–ø–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏** —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –ø–æ—Å—Ç–∞–≤–æ–∫ –ª–∏–Ω–∑ –∏ —Ä–∞—Å—Ç–≤–æ—Ä–æ–≤
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** –≤ –ú–æ–π–°–∫–ª–∞–¥
- **–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ú–æ–π–°–∫–ª–∞–¥ API** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤

## üè∑Ô∏è –¢–∏–ø—ã —Ç–æ–≤–∞—Ä–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª–∞ –∑–∞–∫—É–ø–æ–∫

### üì¶ –û–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–µ –ª–∏–Ω–∑—ã (–∫–æ–¥ 30—Ö—Ö—Ö—Ö)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 3,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 30 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 12 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏:** 0 –¥–Ω–µ–π (—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å = 0)
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 57 –¥–Ω–µ–π (–æ—Ç–¥–µ–ª—å–Ω–æ) / 82 –¥–Ω—è (—Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏)
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 15 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –û–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –ª–∏–Ω–∑—ã

### üì¶ –ú–µ—Å—è—á–Ω—ã–µ –ª–∏–Ω–∑—ã –ø–æ 6 —à—Ç (–∫–æ–¥ 6—Ö—Ö—Ö—Ö)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 5,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 50 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 12 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏:** 0 –¥–Ω–µ–π (—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å = 0)
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 57 –¥–Ω–µ–π (–æ—Ç–¥–µ–ª—å–Ω–æ) / 82 –¥–Ω—è (—Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏)
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 15 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–µ—Å—è—á–Ω—ã–µ –ª–∏–Ω–∑—ã –ø–æ 6 —à—Ç –≤ —É–ø–∞–∫–æ–≤–∫–µ

### üì¶ –ú–µ—Å—è—á–Ω—ã–µ –ª–∏–Ω–∑—ã –ø–æ 3 —à—Ç (–∫–æ–¥ 3—Ö—Ö—Ö—Ö)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 5,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 50 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 12 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏:** 0 –¥–Ω–µ–π (—Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å = 0)
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 57 –¥–Ω–µ–π (–æ—Ç–¥–µ–ª—å–Ω–æ) / 82 –¥–Ω—è (—Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏)
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 15 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–µ—Å—è—á–Ω—ã–µ –ª–∏–Ω–∑—ã –ø–æ 3 —à—Ç –≤ —É–ø–∞–∫–æ–≤–∫–µ

### üß™ –†–∞—Å—Ç–≤–æ—Ä—ã 360 –º–ª (–∫–æ–¥ 360360)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 5,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 24 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 37 –¥–Ω–µ–π (30-45 –¥–Ω–µ–π)
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å –ª–∏–Ω–∑–∞–º–∏:** 37 –¥–Ω–µ–π
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 82 –¥–Ω—è
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 25 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—Ç–≤–æ—Ä—ã –¥–ª—è –ª–∏–Ω–∑ 360 –º–ª

### üß™ –†–∞—Å—Ç–≤–æ—Ä—ã 500 –º–ª (–∫–æ–¥ 500500)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 5,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 24 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 37 –¥–Ω–µ–π (30-45 –¥–Ω–µ–π)
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å –ª–∏–Ω–∑–∞–º–∏:** 37 –¥–Ω–µ–π
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 82 –¥–Ω—è
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 25 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—Ç–≤–æ—Ä—ã –¥–ª—è –ª–∏–Ω–∑ 500 –º–ª

### üß™ –†–∞—Å—Ç–≤–æ—Ä—ã 120 –º–ª (–∫–æ–¥ 120120)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑:** 5,000 —à—Ç
- **–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å:** 48 —à—Ç
- **–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ:** 45 –¥–Ω–µ–π
- **–î–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç–¥–µ–ª—å–Ω–æ:** 37 –¥–Ω–µ–π (30-45 –¥–Ω–µ–π)
- **–î–æ—Å—Ç–∞–≤–∫–∞ —Å –ª–∏–Ω–∑–∞–º–∏:** 37 –¥–Ω–µ–π
- **–û–±—â–∏–π —Å—Ä–æ–∫ –ø–æ—Å—Ç–∞–≤–∫–∏:** 82 –¥–Ω—è
- **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å:** 25 –¥–Ω–µ–π –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –†–∞—Å—Ç–≤–æ—Ä—ã –¥–ª—è –ª–∏–Ω–∑ 120 –º–ª

## üöö –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏

### üí∞ –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞–≤–æ–∫

**–ü—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –ø–æ—Å—Ç–∞–≤–æ–∫ –ª–∏–Ω–∑ —Å —Ä–∞—Å—Ç–≤–æ—Ä–∞–º–∏:**
- **–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –ª–∏–Ω–∑ = 0**
- **–≠–∫–æ–Ω–æ–º–∏—è:** 12 –¥–Ω–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏ –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—Ç–∏—é –ª–∏–Ω–∑
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** –†–∞—Å—Ç–≤–æ—Ä—ã –∑–∞–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–∞ 25 –¥–Ω–µ–π —Ä–∞–Ω—å—à–µ –ª–∏–Ω–∑

### üìÖ –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã –∑–∞–∫–∞–∑–∞

#### –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è –ø–æ—Å—Ç–∞–≤–∫–∞:
1. **–†–∞—Å—Ç–≤–æ—Ä—ã:** –∑–∞–∫–∞–∑ –Ω–∞ 25 –¥–Ω–µ–π —Ä–∞–Ω—å—à–µ –ª–∏–Ω–∑
2. **–õ–∏–Ω–∑—ã:** –∑–∞–∫–∞–∑ –≤ —Ç–µ–∫—É—â–∏–π –¥–µ–Ω—å
3. **–ü–æ—Å—Ç–∞–≤–∫–∞:** —á–µ—Ä–µ–∑ 82 –¥–Ω—è (–æ–±—â–∞—è –¥–∞—Ç–∞)

#### –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ—Å—Ç–∞–≤–∫–∏:
1. **–õ–∏–Ω–∑—ã:** –∑–∞–∫–∞–∑ ‚Üí –ø–æ—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ 57 –¥–Ω–µ–π
2. **–†–∞—Å—Ç–≤–æ—Ä—ã:** –∑–∞–∫–∞–∑ ‚Üí –ø–æ—Å—Ç–∞–≤–∫–∞ —á–µ—Ä–µ–∑ 82 –¥–Ω—è

## ü§ñ ML-–º–æ–¥–µ–ª–∏ –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

### üìä –î–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- **86 SKU** –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã—Ö –ª–∏–Ω–∑ –∏ —Ä–∞—Å—Ç–≤–æ—Ä–æ–≤
- **4 –≥–æ–¥–∞** –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –æ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–∏ –∏ –ø—Ä–æ–¥–∞–∂–∞—Ö
- **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∏ —Ç—Ä–µ–Ω–¥—ã** —Å–ø—Ä–æ—Å–∞

### üßÆ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –∑–∞–∫–∞–∑–∞

#### 1. **–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è**
```python
daily_consumption = ML_forecast(product_code, current_date)
```

#### 2. **–†–∞—Å—á–µ—Ç —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –∑–∞–ø–∞—Å–∞**
```python
safety_stock = ProductRules.calculate_safety_stock(product_code, daily_consumption)
```

#### 3. **–†–∞—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –∑–∞–∫–∞–∑–∞**
```python
recommended_order = max(0, safety_stock - current_stock)
```

#### 4. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π**
```python
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–∫–∞–∑
quantity = max(recommended_order, min_order)

# –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —É–ø–∞–∫–æ–≤–∫–∏
quantity = ((quantity + multiple - 1) // multiple) * multiple
```

### üîÑ –£—Å–ª–æ–≤–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
```python
total_lead_time = production_days + delivery_days
critical_days = total_lead_time + safety_stock_days
should_create = (days_until_oos <= critical_days) and (recommended_order >= min_order)
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository_url>
cd MoySklad

# –°–æ–∑–¥–∞–µ–º .env —Ñ–∞–π–ª
cp env.example .env
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º .env —Å –≤–∞—à–∏–º MOYSKLAD_API_TOKEN
```

### 2. **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ú–æ–π–°–∫–ª–∞–¥**
```bash
# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ 4 –≥–æ–¥–∞
python services/moysklad-service/app/export_production_data.py
```

### 3. **–û–±—É—á–µ–Ω–∏–µ ML-–º–æ–¥–µ–ª–µ–π**
```bash
# –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
python services/moysklad-service/app/train_production_models.py
```

### 4. **–ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã**
```bash
# –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å—é —Å–∏—Å—Ç–µ–º—É
./start_system.sh
```

## üì° API Endpoints

### üîç –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø—Ä–æ—Å–∞
```http
POST /forecast
Content-Type: application/json

{
  "product_code": "30001",
  "forecast_days": 30
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "product_code": "30001",
  "current_stock": 1500,
  "forecast_consumption": 85.5,
  "days_until_oos": 17,
  "recommended_order": 2100,
  "final_order": 3000,
  "confidence": 0.85,
  "models_used": ["linear_regression", "random_forest"],
  "model_type": "production",
  "product_info": {
    "type": "daily_lenses",
    "description": "–û–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–µ –ª–∏–Ω–∑—ã",
    "min_order": 3000,
    "multiple": 30,
    "production_days": 45,
    "delivery_days": 12,
    "total_lead_time": 57,
    "safety_stock_days": 15,
    "category": "lenses",
    "can_combine_delivery": true
  },
  "order_validation": {
    "valid": true,
    "message": "–ó–∞–∫–∞–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º"
  }
}
```

### üöö –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏
```http
POST /delivery/optimize
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "optimization_result": {
    "can_combine_delivery": true,
    "lenses_count": 3,
    "solutions_count": 2,
    "delivery_savings_days": 36,
    "recommended_action": "combine_delivery",
    "optimal_order_dates": {
      "lenses_order_date": "2024-01-15",
      "solutions_order_date": "2024-01-10",
      "combined_delivery_date": "2024-03-15",
      "delivery_strategy": "combined"
    }
  }
}
```

### üìã –ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
```http
GET /delivery/rules
```

### üõí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
```http
POST /auto-purchase
Content-Type: application/json

{
  "product_code": "30001"
}
```

## üîÑ –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### ‚è∞ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- **–í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:** 6:00 –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í—Å–µ 86 SKU
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏:** –ê–Ω–∞–ª–∏–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤–æ–∫
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### üìã –ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤** –∏–∑ –ú–æ–π–°–∫–ª–∞–¥ API
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
3. **ML-–ø—Ä–æ–≥–Ω–æ–∑** –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è
4. **–ê–Ω–∞–ª–∏–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏**
5. **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞** —Å —É—á–µ—Ç–æ–º –ø—Ä–∞–≤–∏–ª –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–∞–≤–æ–∫
6. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤**

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á–µ—Ç—ã

### üìà –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤**
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤**
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏** (—ç–∫–æ–Ω–æ–º–∏—è –¥–Ω–µ–π)
- **–û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ç–æ–≤–∞—Ä–æ–≤**

### üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
- **–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤:** R¬≤ > 0.90
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API:** < 2 —Å–µ–∫—É–Ω–¥—ã
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:** 99.9%
- **–≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–µ:** –¥–æ 36 –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### üê≥ Docker Services
```yaml
services:
  postgres:          # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  redis:             # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
  rabbitmq:          # –û—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
  forecast-api:      # API –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
  automation-cron:   # –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
```

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
services/moysklad-service/app/
‚îú‚îÄ‚îÄ api_ml.py                    # –û—Å–Ω–æ–≤–Ω–æ–π API —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏
‚îú‚îÄ‚îÄ product_rules.py             # –ü—Ä–∞–≤–∏–ª–∞ –∑–∞–∫—É–ø–æ–∫ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π
‚îú‚îÄ‚îÄ delivery_optimizer.py        # –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏
‚îú‚îÄ‚îÄ train_production_models.py   # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îú‚îÄ‚îÄ export_production_data.py    # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ daily_automation.py          # –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### ‚öôÔ∏è –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ú–æ–π–°–∫–ª–∞–¥ API
MOYSKLAD_API_TOKEN=your_token_here

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql://user:pass@host:port/db

# Redis
REDIS_URL=redis://host:port

# API URL
FORECAST_API_URL=http://forecast-api:8000
```

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **API —Ç–æ–∫–µ–Ω—ã** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **HTTPS** –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### ‚ùå –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. **–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–æ–≤ –º–æ–¥–µ–ª–µ–π
ls -la data/production_forecast_models.pkl
ls -la data/production_stock_data.csv
```

#### 2. **–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ú–æ–π–°–∫–ª–∞–¥**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω API
echo $MOYSKLAD_API_TOKEN

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API
curl -H "Authorization: Bearer $MOYSKLAD_API_TOKEN" \
     https://api.moysklad.ru/api/remap/1.2/entity/assortment
```

#### 3. **–û—à–∏–±–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –æ–±–µ–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∞–≤–∏–ª –¥–æ—Å—Ç–∞–≤–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- **–õ–æ–≥–∏:** `docker-compose logs forecast-api`
- **–°—Ç–∞—Ç—É—Å:** `curl http://localhost:8001/health`
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** `curl http://localhost:8001/delivery/optimize`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** –°–º. README.md

## üéØ –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å

### üí∞ –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç
- **–°–Ω–∏–∂–µ–Ω–∏–µ –¥–µ—Ñ–∏—Ü–∏—Ç–∞** –Ω–∞ 80%
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø–∞—Å–æ–≤** –Ω–∞ 30%
- **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏** –Ω–∞ –∑–∞–∫—É–ø–∫–∏ –Ω–∞ 90%
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏** –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ 25%
- **–≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–µ** –¥–æ 36 –¥–Ω–µ–π –≤ –º–µ—Å—è—Ü

### üìà KPI —Å–∏—Å—Ç–µ–º—ã
- **–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–æ–≤:** > 90%
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:** < 2 —Å–µ–∫
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:** 95% –∑–∞–∫–∞–∑–æ–≤
- **–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏:** 40 —á–∞—Å–æ–≤/–º–µ—Å—è—Ü
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–æ—Å—Ç–∞–≤–∫–∏:** –¥–æ 60% —ç–∫–æ–Ω–æ–º–∏–∏

---

**üéâ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –¥–æ—Å—Ç–∞–≤–∫–∏!** 